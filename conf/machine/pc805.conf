#@TYPE: Machine
#@NAME: pc805
#@SOC: PC805
#@DESCRIPTION: Machine configuration for the PC805

require conf/machine/include/riscv/tune-riscv.inc
require conf/machine/include/picocom-linux.inc

DEFAULTTUNE = "riscv32"
MACHINE_FEATURES = "serial"

KERNEL_CLASSES = "kernel-fitimage"
KERNEL_IMAGETYPE = "Image"

KERNEL_DEVICETREE ?= "pc805.dtb"
KBUILD_DEFCONFIG = "pc805_defconfig"


EXTRA_IMAGEDEPENDS += "opensbi-picocom"
RISCV_SBI_PLAT = "picocom/pc805"
OPENSBI_EXTRA_OEMAKE = " \
    PLATFORM_RISCV_XLEN=32 \
    PLATFORM_RISCV_ABI=ilp32d \
    PLATFORM_RISCV_ISA=rv32gc \
"

## unused file
# Use pc805.dts with the updated opensbi
#RISCV_SBI_FDT ?= "ae350_c4_64_d.dtb"

MACHINE_EXTRA_RECOMMENDS += "kernel-modules"
UBOOT_MACHINE = "pc805_defconfig"
UBOOT_SUFFIX ?= "itb"

# U-Boot SPL
SPL_BINARY ?= "spl/u-boot-spl.bin"


UBOOT_ENTRYPOINT = "0x600000"
UBOOT_DTB_LOADADDRESS = "0x20000000"
